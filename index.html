<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda de Citas Veterinarias</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <style>
    body {
      background-image: url(animalesgranja.jpeg);
    }

    .container {
      text-align: center;
      width: 100%;
      height: 100%;
      padding: 3px;
      background-color: rgba(252, 250, 250, 0.582);
      color: rgb(26, 1, 50);
      font-weight: bold;
    }

    .boton {
      width: 150px;
      height: 50px;
      background-color: rgba(255, 192, 203, 0.653);
      color: rgb(5, 5, 175);
      font-weight: bold;
      font-size: large;
      border-radius: 10%;
      cursor: pointer;
    }

    .radio {
      font-size: x-large;
      text-align: center;
    }

    #tarjetasContainer {
      display: flex;
      flex-wrap: wrap;
    }

    .tarjeta {
      border: 3px solid black;
      margin: 10px;
      padding: 10px;
      width: 300px;
      text-align: center;
      position: relative;
      background-color: rgba(201, 57, 233, 0.634);
      color: black;
      font-weight: bold;
      border-radius: 15px;
    }

    .tarjeta img {
      max-width: 150px;
      height: auto;
    }

    .editarBtn,
    .estadoDropdown {
      border: 3px solid rgba(0, 0, 0, 0.892);
      width: 100px;
      right: 5px;
      border-radius: 5px;
      cursor: pointer;
      color: blue;
      margin-left: 5px;
      font-size: large;
      background-color: rgb(199, 196, 255);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>AGENDA DE CITAS VETERINARIAS</h1>

    <div class="radio">
      <h3>ORGANIZAR POR: </h3>
      <input type="radio" name="filtro" value="abierta" checked> Abierta <br><br>
      <input type="radio" name="filtro" value="anulada"> Anulada <br><br>
      <input type="radio" name="filtro" value="terminada"> Terminada <br><br>
    </div>

    <div id="citasContainer">
      <div id="tarjetasContainer">
        
      </div>
    </div>

    <button onclick="mostrarFormulario()" class="boton">Agendar Cita</button>
  </div>

  <script>
    let citas = {
      abierta: [],
      anulada: [],
      terminada: []
    };

    function mostrarFormulario() {
        Swal.fire({
        title: 'Ingrese la información',
        html:
          '<input id="nombre" placeholder="Nombre Mascota" class="swal2-input">' +
          '<input id="propietario" placeholder="Nombre Propietario" class="swal2-input">' +
          '<select id="tipomascota" class="swal2-input">' +
            '<option value="seleccionar">Seleccionar</option>' +
            '<option value="perros">Perros</option>' +
            '<option value="gatos">Gatos</option>' +
            '<option value="aves">Aves</option>' +
            '<option value="anfibios">Anfibios</option>' +
            '<option value="otros">Otros</option>' +
          '</select>' +
          '<input id="tel" type="phone" placeholder="Número Teléfono" class="swal2-input">' +
          '<input id="fecha" type="date" placeholder="Fecha" class="swal2-input">' +
          '<input id="hora" type="time" placeholder="Hora" class="swal2-input">' +
          '<textarea id="sintomas" placeholder="Síntomas" class="swal2-input"></textarea>',
        focusConfirm: false,
        showCancelButton: true,
        preConfirm: () => {
          const nombre = Swal.getPopup().querySelector('#nombre').value;
          const propietario = Swal.getPopup().querySelector('#propietario').value;
          const tipomascota = Swal.getPopup().querySelector('#tipomascota').value;
          const tel = Swal.getPopup().querySelector('#tel').value;
          const fecha = Swal.getPopup().querySelector('#fecha').value;
          const hora = Swal.getPopup().querySelector('#hora').value;
          const sintomas = Swal.getPopup().querySelector('#sintomas').value;

          if (!nombre || !propietario || !tipomascota || !tel || !fecha || !hora || !sintomas) {
            Swal.showValidationMessage('Todos los campos son obligatorios');
            return false;
          }

          
          const dosDiasDespues = new Date();
          dosDiasDespues.setDate(dosDiasDespues.getDate() + 1);
          const dosDiasDespuesFormateada = dosDiasDespues.toISOString().split('T')[0];
          if (fecha < dosDiasDespuesFormateada) {
            Swal.showValidationMessage('Seleccione una fecha válida (mínimo dos días después de hoy)');
            return false;
          }

          
          if (hora < '08:00' || hora > '17:00') {
            Swal.showValidationMessage('Seleccione una hora válida (de 8:00 A.M. a 5:00 P.M.)');
            return false;
          }

          return { nombre, propietario, tipomascota, tel, fecha, hora, sintomas };
        }
      }).then((result) => {
        if (result.isConfirmed) {
          const nuevaCita = {
            estado: 'abierta',
            nombre: result.value.nombre,
            propietario: result.value.propietario,
            tipomascota: result.value.tipomascota,
            tel: result.value.tel,
            fecha: result.value.fecha,
            hora: result.value.hora,
            sintomas: result.value.sintomas
          };

          citas.abierta.push(nuevaCita);
          actualizarListaCitas();
          mostrarTarjetas();
          Swal.fire('Registro guardado con éxito');
          limpiarFormulario();
        }
      });
    
    }

    function limpiarFormulario() {
        document.getElementById('nombre').value = '';
      document.getElementById('propietario').value = '';
      document.getElementById('tipomascota').selectedIndex = 0;
      document.getElementById('tel').value = '';
      document.getElementById('fecha').value = '';
      document.getElementById('hora').value = '';
      document.getElementById('sintomas').value = '';
    }

    function actualizarListaCitas() {
      
    }

    function mostrarTarjetas(citasFiltradas) {
        const tarjetasContainer = document.getElementById('tarjetasContainer');
        tarjetasContainer.innerHTML = '';

        const citasMostrar = citasFiltradas || getCitasParaMostrar();

        citasMostrar.forEach(cita => {
          crearTarjeta(cita);
        });
      }

   
    function crearTarjeta(cita) {
      const tarjetasContainer = document.getElementById('tarjetasContainer');
      const tarjeta = document.createElement('div');
      tarjeta.className = 'tarjeta';

      const tipoMascota = cita.tipomascota.toLowerCase();
      const imagen = document.createElement('img');
     
      if (tipoMascota === "perros") {
    imagen.src = "./ANIMALES.gif";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
} else if (tipoMascota === 'gatos') {
    imagen.src = "./Navidad-04.gif";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
} else if (tipoMascota === 'aves') {
    imagen.src = "./ave2.gif";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
} else if (tipoMascota === 'anfibios') {
    imagen.src = "./anfibios.gif";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
} else if (tipoMascota === 'otros') {
    imagen.src = "./farm.png";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
} else {
    
    imagen.src = "./default-image.jpg";
    imagen.alt = tipoMascota;
      tarjeta.appendChild(imagen);
}
      

      for (const key in cita) {
        const parrafo = document.createElement('p');
        parrafo.textContent = `${key.charAt(0).toUpperCase() + key.slice(1)}: ${cita[key]}`;
        tarjeta.appendChild(parrafo);
      }

      const estadoDropdown = document.createElement('select');
      estadoDropdown.innerHTML = `
        <option value="abierta" ${cita.estado === 'abierta' ? 'selected' : ''}>Abierta</option>
        <option value="terminada" ${cita.estado === 'terminada' ? 'selected' : ''}>Terminada</option>
        <option value="anulada" ${cita.estado === 'anulada' ? 'selected' : ''}>Anulada</option> `;
      estadoDropdown.onchange = (event) => cambiarEstadoCita(cita, event.target.value);
      estadoDropdown.className = 'estadoDropdown';
      tarjeta.appendChild(estadoDropdown);

      const editarBtn = document.createElement('button');
      editarBtn.textContent = 'Editar';
      editarBtn.onclick = () => editarCita(cita);
      editarBtn.className = 'editarBtn';
      tarjeta.appendChild(editarBtn);

      tarjetasContainer.appendChild(tarjeta);
    }

   
    function getCitasParaMostrar() {
        return [
          ...citas.abierta,
          ...citas.anulada,
          ...citas.terminada
        ];
       
      }
   
    function cambiarEstadoCita(cita, nuevoEstado) {
  
  cita.estado = nuevoEstado;

 
  const citasFiltradas = citas[nuevoEstado];

  
  mostrarTarjetas(citasFiltradas);
}


function mostrarTarjetas(citasFiltradas) {
  const tarjetasContainer = document.getElementById('tarjetasContainer');
  tarjetasContainer.innerHTML = '';

 
  const citasMostrar = citasFiltradas || getCitasParaMostrar();

  citasMostrar.forEach(cita => {
    crearTarjeta(cita);
  });
}



    
    function editarCita(cita) {
      Swal.fire({
        title: 'Editar Cita',
        html:
          '<input id="nombre" placeholder="Nombre Mascota" class="swal2-input" value="' + cita.nombre + '">' +
          '<input id="propietario" placeholder="Nombre Propietario" class="swal2-input" value="' + cita.propietario + '">' +
          '<select id="tipomascota" class="swal2-input">' +
            '<option value="seleccionar">Seleccionar</option>' +
            '<option value="perros" ' + (cita.tipomascota === 'perros' ? 'selected' : '') + '>Perros</option>' +
            '<option value="gatos" ' + (cita.tipomascota === 'gatos' ? 'selected' : '') + '>Gatos</option>' +
            '<option value="aves" ' + (cita.tipomascota === 'aves' ? 'selected' : '') + '>Aves</option>' +
            '<option value="anfibios" ' + (cita.tipomascota === 'anfibios' ? 'selected' : '') + '>Anfibios</option>' +
            '<option value="otros" ' + (cita.tipomascota === 'otros' ? 'selected' : '') + '>Otros</option>' +
          '</select>' +
          '<input id="tel" type="phone" placeholder="Número Teléfono" class="swal2-input" value="' + cita.tel + '">' +
          '<input id="fecha" type="date" placeholder="Fecha" class="swal2-input" value="' + cita.fecha + '">' +
          '<input id="hora" type="time" placeholder="Hora" class="swal2-input" value="' + cita.hora + '">' +
          '<textarea id="sintomas" placeholder="Síntomas" class="swal2-input">' + cita.sintomas + '</textarea>',
        focusConfirm: false,
        showCancelButton: true,
        preConfirm: () => {
            const nombre = Swal.getPopup().querySelector('#nombre').value;
      const propietario = Swal.getPopup().querySelector('#propietario').value;
      const tipomascota = Swal.getPopup().querySelector('#tipomascota').value;
      const tel = Swal.getPopup().querySelector('#tel').value;
      const fecha = Swal.getPopup().querySelector('#fecha').value;
      const hora = Swal.getPopup().querySelector('#hora').value;
      const sintomas = Swal.getPopup().querySelector('#sintomas').value;

      if (!nombre || !propietario || !tipomascota || !tel || !fecha || !hora || !sintomas) {
        Swal.showValidationMessage('Todos los campos son obligatorios');
        return false;
      }

      
      cita.nombre = nombre;
      cita.propietario = propietario;
      cita.tipomascota = tipomascota;
      cita.tel = tel;
      cita.fecha = fecha;
      cita.hora = hora;
      cita.sintomas = sintomas;

      Swal.fire('Cita editada con éxito');
      mostrarTarjetas();
        }
      });
    }

    const radioButtons = document.querySelectorAll('input[name="filtro"]');
      radioButtons.forEach(radio => {
        radio.addEventListener('change', () => {
          mostrarTarjetas();
        });
      });
    
    mostrarTarjetas();

    
  </script>
</body>
</html>